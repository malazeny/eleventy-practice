{% extends "base.njk" %}

{% block content %}
  {% if heroImage %}
    <img class="hero-image" src="{{ '/assets/cat_working.jpeg' | prefixedUrl }}">
  {% endif %} 

  {% if featured %}
    <div class="featured-banner">🌟 Featured Post!</div>
  {% endif %}

  <article>
    <h2>{{ title }}</h2>
    {% if date %}
      <p><em>{{ date | readableDate }}</em></p>
    {% endif %}

    {{ content | safe }}
  </article>

  {% if carousel %}
  <div class="carousel">
    <button class="arrow left">←</button>

    <div class="carousel-content">
      <img id="carousel-image" src="{{ carousel[0].src }}" alt="Carousel image">
      <div id="carousel-caption" class="carousel-caption">{{ carousel[0].caption }}</div>
    </div>

    <button class="arrow right">→</button>
  </div>
{% endif %}

{% endblock %}

{% block scripts %}
  {% if carousel %}
    <script>
      const images = {{ carousel | dump | safe }};
      let currentIndex = 0;

      document.addEventListener("DOMContentLoaded", () => {
        const imageEl = document.getElementById("carousel-image");
        const captionEl = document.getElementById("carousel-caption");

        function showImage(index) {
          imageEl.src = images[index].src;
          captionEl.textContent = images[index].caption;
        }

        document.querySelector(".arrow.left").addEventListener("click", () => {
          currentIndex = (currentIndex - 1 + images.length) % images.length;
          showImage(currentIndex);
        });

        document.querySelector(".arrow.right").addEventListener("click", () => {
          currentIndex = (currentIndex + 1) % images.length;
          showImage(currentIndex);
        });
      });
    </script>
  {% endif %}
{% endblock %}
